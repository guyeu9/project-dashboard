# 提案：统一新建项目表单

## Context

当前系统中存在两个不同的项目创建界面：

1. **SmartParser 中的新建项目模态框**（`src/components/SmartParser/index.tsx`）
   - 只包含"项目名称"和"项目描述"两个字段
   - 创建项目时使用大量默认值（负责人、产品经理、PMO、团队成员等都是空的或默认值）
   - 用户创建项目后需要再次编辑来补全信息

2. **ProjectEditModal**（`src/components/ProjectEditModal/index.tsx`）
   - 完整的项目表单，包含所有字段
   - 支持编辑和新建项目
   - 字段包括：项目名称、状态、进度、负责人、产品经理、PMO、开始/结束日期、合作方、开发人员、测试人员、联调群链接、对方联系人、备注

这种不一致导致：
- 用户体验不统一
- 创建项目后需要再次编辑来补全信息，浪费用户时间
- 代码重复，维护成本高

## Scope

### 涉及文件
- `src/components/SmartParser/index.tsx` - 移除简化的新建项目模态框，改用 ProjectEditModal
- `src/components/ProjectEditModal/index.tsx` - 添加支持"创建后导入任务"的回调机制

### 修改内容
1. **ProjectEditModal 组件增强**
   - 添加可选的 `onProjectCreated` 回调属性
   - 当创建新项目成功后，触发回调，传递新创建的项目对象
   - 保持现有功能不变（向后兼容）

2. **SmartParser 组件重构**
   - 移除 `newProjectModalVisible`、`newProjectName`、`newProjectDescription` 等状态
   - 移除简化的新建项目模态框（第 413-460 行）
   - 使用 `ProjectEditModal` 组件替代
   - 通过 `onProjectCreated` 回调接收新项目，然后导入任务

## Behavior

### 修改前流程
```
用户点击"新建项目"
  ↓
弹出简化表单（仅名称+描述）
  ↓
用户填写基本信息
  ↓
点击"确认创建并导入任务"
  ↓
创建项目（使用默认值）+ 导入任务
  ↓
用户需要再次编辑项目来补全信息
```

### 修改后流程
```
用户点击"新建项目"
  ↓
弹出完整的项目表单（与 ProjectEditModal 相同）
  ↓
用户填写完整信息（名称、负责人、产品经理、PMO、团队成员、日期等）
  ↓
点击"保存"
  ↓
创建项目（包含完整信息）+ 自动导入任务
  ↓
完成
```

### 输入/输出规范

**输入：**
- 用户在完整表单中填写所有项目信息
- 必填字段：项目名称
- 可选字段：状态、进度、负责人、产品经理、PMO、开始/结束日期、合作方、开发人员、测试人员、联调群链接、对方联系人、备注

**输出：**
- 创建包含完整信息的项目对象
- 自动导入解析的任务到新项目
- 显示成功提示消息

## Risks

### 技术风险
1. **集成风险**：需要确保 SmartParser 的导入流程与 ProjectEditModal 的创建流程正确集成
   - 缓解措施：仔细测试新建项目并导入任务的完整流程

2. **状态管理风险**：SmartParser 和 ProjectEditModal 之间的状态传递可能出错
   - 缓解措施：使用明确的回调机制，避免直接操作对方组件的状态

3. **表单验证风险**：完整表单的验证规则可能与简化表单不同
   - 缓解措施：保持 ProjectEditModal 现有的验证规则不变

### 兼容性风险
1. **向后兼容性**：需要确保 ProjectEditModal 的现有使用场景不受影响
   - 缓解措施：`onProjectCreated` 回调是可选的，不传递时行为不变

2. **用户体验变化**：用户需要填写更多信息才能创建项目
   - 缓解措施：提供合理的默认值，减少必填字段

### 业务风险
1. **用户习惯变化**：用户可能习惯了简化的创建流程
   - 缓解措施：在界面上提供清晰的提示和引导

## Success Criteria

### 功能验收标准
1. ✅ SmartParser 点击"新建项目"按钮时，弹出完整的项目表单
2. ✅ 用户可以在表单中填写所有项目信息（与 ProjectEditModal 相同）
3. ✅ 点击"保存"后，成功创建项目并自动导入解析的任务
4. ✅ 创建的项目包含用户填写的完整信息，而不是默认值
5. ✅ ProjectManagement 页面的"新建项目"功能不受影响
6. ✅ 表单验证正常工作，必填字段校验有效

### 用户体验验收标准
1. ✅ 创建项目的流程流畅，没有卡顿或错误
2. ✅ 提示消息清晰明确
3. ✅ 创建成功后，自动跳转到项目详情或保持当前页面（根据现有行为）

## Timeline

- **阶段 1**：修改 ProjectEditModal 组件（30 分钟）
- **阶段 2**：修改 SmartParser 组件（30 分钟）
- **阶段 3**：测试验证（30 分钟）
- **总计**：约 1.5 小时